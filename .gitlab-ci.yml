stages:
  - test
  - deploy

test:
  image: node:13-alpine
  stage: test
  environment:
    name: test
  script:
    - apk add --no-cache python3 make g++
    - npm ci
    - npx ng build

deploy:
  image: node:13-alpine
  stage: deploy
  environment:
    name: test
  script:
    - apk add --no-cache python3 make g++
    - npm ci
    - ngx ng build
    - ngx firebase --project phaenonet --token "$FIREBASE_TOKEN" deploy
  only:
    - master
